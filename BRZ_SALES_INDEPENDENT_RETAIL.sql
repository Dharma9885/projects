{{ config(
    materialized="table",
    schema='SALES'
) }}

SELECT 
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
 FWK_ID, 
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
REGN_KEY,
TRTRY_KEY,
DLR_SLS_MGR,
PDM_ID,
SLS_DEV_SPCL,
DIST_ID,
SBD_ENTY_NBR,
SBD_PRNT_ENTY,
DIV_ID,
HUSTLER_DLR_NBR,
DLR_NAME,
DLR_LNAME,
DLR_STATE,
DLR_CNTRY,
PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
SHIP_FROM,
ORD_TYP,
TO_DECIMAL(ORD_QTY, 30, 2) AS QTY,
TO_DECIMAL(AMOUNT,30,2) AS AMOUNT,
TO_DECIMAL(AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
ORD_LN_NBR,
DATE(TXN_DTE) AS TXN_DTE,
TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
PO_NBR,
NULL AS INVC_NBR,
NULL AS INVC_LN_NBR,
NULL AS SERL_NBR,
NULL AS SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
DATE(ORD_DTE) AS ORD_DTE,
DATE(ORD_DUE_DATE) AS ORD_DUE_DATE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
TO_DECIMAL(SLS_ORD_QTY,30,2) AS SLS_ORD_QTY,
TO_DECIMAL(SHIP_QTY,30,2) AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
ORD_STAT_FLAG,
OPEN_ORDER_FLAG,
ORD_LN_KEY,
ORD_NBR,
BRAND_UU40,
CRNCY_KEY,
ORD_HOLD_FLAG,
DATE(MFG_DUE_DATE) AS MFG_DUE_DATE,
DATE(QUOTE_ORDER_DATE) AS QUOTE_ORDER_DATE,
ORD_APRV_STAT,
OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS  SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
DLR_NBR AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
CAST(BRZ_REF_DTE AS VARCHAR) AS BRZ_REF_DTE
FROM {{source('SALES_BRZ', 'BRZ_SALES_ORDER_INDEPENDENT_RETAIL')}}
   WHERE COALESCE(TRIM(TRTRY_KEY), '0') NOT IN ('93')



UNION ALL
------------------------------------------------------------------BILLING-----------------------------------------------------

/*SELECT
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
 FWK_ID,
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
REGN_KEY,
TRTRY_KEY,
DLR_SLS_MGR,
PDM_ID,
SLS_DEV_SPCL,
DIST_ID,
SBD_ENTY_NBR,
SBD_PRNT_ENTY,
DIV_ID,
HUSTLER_DLR_NBR,
DLR_NAME,
DLR_LNAME,
DLR_STATE,
DLR_CNTRY,
PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
SHIP_FROM,
ORD_TYP,
TO_DECIMAL(INV_QTY, 30, 2) AS QTY,
TO_DECIMAL(AMOUNT,30,2) AS AMOUNT,
TO_DECIMAL(AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
ORD_LN_NBR,
DATE(TXN_DTE),
TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
PO_NBR,
INVC_NBR,
INVC_LN_NBR,
SERL_NBR,
SITE_ID,
LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
DATE(ORD_DTE) AS ORD_DTE,
DATE(ORD_DUE_DTE) AS ORD_DUE_DTE,
DATE(INV_DTE) AS INV_DTE,
DATE(INV_PO_DTE) AS INV_PO_DTE,
DATE(FULL_DUE_DTE) AS FULL_DUE_DTE,
TO_DECIMAL(SLS_ORD_QTY,30,2) AS SLS_ORD_QTY,
TO_DECIMAL(SHIP_QTY,30,2) AS SHIP_QTY,
--NULL AS FL_PLN_AG,
CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
INVC_LN_KEY,
ORD_NBR,
BRAND_UU40,
CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS  SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
DLR_NBR AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
SLS_ORD_FROM_WHSE_KEY,
CREDIT_RESN_LN,   
CAST(BRZ_REF_DTE AS VARCHAR) AS BRZ_REF_DTE

FROM {{source('SALES_BRZ', 'BRZ_SALES_BILLING_INDEPENDENT_RETAIL')}}
      WHERE TRTRY_KEY != '93'


UNION ALL*/

------------------------------------FORECAST-------------------------------------------------------------------------
SELECT
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
FWK_ID,
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
NULL AS REGN_KEY,
NULL AS TRTRY_KEY,
NULL AS DLR_SLS_MGR,
NULL AS PDM_ID,
NULL AS SLS_DEV_SPCL,
NULL AS DIST_ID,
NULL AS SBD_ENTY_NBR,
NULL AS SBD_PRNT_ENTY,
DIV_ID,
NULL AS HUSTLER_DLR_NBR,
NULL AS DLR_NAME,
NULL AS DLR_LNAME,
NULL AS DLR_STATE,
NULL AS DLR_CNTRY,
PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(SLS_FCST_QTY, 30, 2) AS QTY,
TO_DECIMAL(AMOUNT,30,2) AS AMOUNT,
NULL AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
NULL AS ORD_LN_NBR,
NULL AS TXN_DTE,
NULL AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
NULL AS PO_NBR,
NULL AS INVC_NBR,
NULL AS INVC_LN_NBR,
NULL  AS  SERL_NBR,
NULL AS SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DTE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
NULL AS ORD_NBR,
BRAND_UU40,
CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS  SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
DATE(FCST_START_DTE) AS FCST_START_DTE,
FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
NULL AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
CAST(BRZ_REF_DTE AS VARCHAR) AS BRZ_REF_DTE

FROM {{source('SALES_BRZ', 'BRZ_SALES_FORECAST_INDEPENDENT_RETAIL')}}



UNION ALL

-----------------------------------------------PRODUCTION_PLAN-------------------------------------------------
SELECT
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
 FWK_ID,
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
NULL AS REGN_KEY,
NULL AS TRTRY_KEY,
NULL AS DLR_SLS_MGR,
NULL AS PDM_ID,
NULL AS SLS_DEV_SPCL,
NULL AS DIST_ID,
NULL AS SBD_ENTY_NBR,
NULL AS SBD_PRNT_ENTY,
NULL AS DIV_ID,
NULL  AS  HUSTLER_DLR_NBR,
NULL AS DLR_NAME,
NULL AS DLR_LNAME,
NULL AS DLR_STATE,
NULL AS DLR_CNTRY,
PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(PROD_QTY, 30, 2) AS QTY,
NULL AS AMOUNT,
TO_DECIMAL(AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--NULL AS TXN_ID,
NULL AS ORD_LN_NBR,
NULL AS TXN_DTE,
NULL AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
NULL AS PO_NBR,
NULL AS INVC_NBR,
NULL AS INVC_LN_NBR,
NULL AS SERL_NBR,
SITE_ID,
NULL AS LOC_ID,
LOC_KEY,
NULL AS LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
NULL AS ORD_NBR,
BRAND_UU40,
NULL AS CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
NULL AS  FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
NULL AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
CAST(BRZ_REF_DTE AS  VARCHAR) AS BRZ_REF_DTE

FROM {{source('SALES_BRZ', 'BRZ_SALES_PRODUCTION_PLAN_INDEPENDENT_RETAIL')}}



  UNION ALL

  -----------------------------------------------------SETTLEMNTS-----------------------------------------

  SELECT
A.CTGY_ID AS CTGY_ID,
A.CTGY_TYP AS CTGY_TYP,
A.CTGY_SHORT_NAME AS CTGY_SHORT_NAME,
A.SRC_SYS_KEY AS SRC_SYS_KEY,
A.PROD_CTGY AS PROD_CTGY,
A.FYR_ID AS FYR_ID,
A.FMTH_ID AS FMTH_ID,
 A.FWK_ID AS FWK_ID,
CAST (A.PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(A.PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (A.CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (A.CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
A.REGN_KEY AS REGN_KEY,
A.TRTRY_KEY AS TRTRY_KEY,
A.DLR_SLS_MGR AS DLR_SLS_MGR,
A.PDM_ID AS PDM_ID,
A.SLS_DEV_SPCL AS SLS_DEV_SPCL,
A.DIST_ID AS DIST_ID,
A.SBD_ENTY_NBR AS SBD_ENTY_NBR,
A.SBD_PRNT_ENTY AS SBD_PRNT_ENTY,
A.DIV_ID AS DIV_ID,
A.HUSTLER_DLR_NBR AS HUSTLER_DLR_NBR,
A.DLR_NAME AS DLR_NAME,
A.DLR_LNAME AS DLR_LNAME,
A.DLR_STATE AS DLR_STATE,
A.DLR_CNTRY AS DLR_CNTRY,
A.PRODTN_LN_NBR AS PRODTN_LN_NBR,
A.BRAND AS BRAND,
A.PROD_LN_KEY AS PROD_LN_KEY,
--PROD_LN_DESC,
A.PROD_KEY AS PROD_KEY,
A.PROD_DESC AS PROD_DESC,
A.IR_DTL_SKU AS IR_DTL_SKU,
A.PROD_STAT AS PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(A.PROD_QTY, 30, 2) AS QTY,
TO_DECIMAL(A.AMOUNT,30,2) AS AMOUNT,
TO_DECIMAL(A.AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(A.EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
NULL AS ORD_LN_NBR,
DATE(A.TXN_DTE) AS TXN_DTE ,
 A.TXN_TM AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
PO_NBR AS PO_NBR,
A.INVC_NBR AS INVC_NBR,
NULL AS INV_LN_NBR,
A.SERL_NBR AS SERL_NBR,
NULL AS SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
DATE(A.INV_DTE) AS INV_DTE,
NULL AS INV_PO_DTE,
DATE(A.FULL_DUE_DTE) AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--A.FL_PLN_AG AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
A.ORD_NBR AS ORD_NBR,
NULL  AS BRAND_UU40,
NULL AS CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
A.LOAN_ID AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
 A.SETLMT_FLAG AS SETLMT_FLAG,
 CASE WHEN B.SERL_NBR = A.SERL_NBR THEN 'Y' ELSE 'N' END AS REGISTRATION_FLAG,
 A.CASH_SETTLEMENT_FLAG AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
DATE(A.SETTLEMENT_DTE)AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
 NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
DLR_NBR AS DLR_NBR,
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
A.BRZ_REF_DTE AS BRZ_REF_DTE
FROM  {{source('SALES_BRZ', 'BRZ_SALES_SETTLEMENT_INDEPENDENT_RETAIL')}} A
LEFT JOIN (SELECT DISTINCT SERL_NBR,SRC_SYS_KEY  FROM  {{source('SALES_BRZ', 'BRZ_SALES_REGISTRATIONS_INDEPENDENT_RETAIL')}}) B
ON A.SERL_NBR = B.SERL_NBR 
AND A.SRC_SYS_KEY=B.SRC_SYS_KEY
 AND COALESCE(TRIM(A.TRTRY_KEY), '0') NOT IN ('93')
UNION ALL

-------------------------------------------FLOORPLAN------------------------------------------------

SELECT
A.CTGY_ID AS CTGY_ID,
A.CTGY_TYP AS CTGY_TYP,
A.CTGY_SHORT_NAME AS CTGY_SHORT_NAME,
A.SRC_SYS_KEY AS SRC_SYS_KEY,
A.PROD_CTGY AS PROD_CTGY,
A.FYR_ID AS FYR_ID,
A.FMTH_ID AS FMTH_ID,
A.FWK_ID AS FWK_ID,
CAST (A.PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(A.PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (A.CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (A.CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
A.REGN_KEY AS REGN_KEY,
A.TRTRY_KEY AS TRTRY_KEY,
A.DLR_SLS_MGR AS DLR_SLS_MGR,
A.PDM_ID AS PDM_ID,
A.SLS_DEV_SPCL AS SLS_DEV_SPCL,
A.DIST_ID AS DIST_ID,
A.SBD_ENTY_NBR AS SBD_ENTY_NBR,
A.SBD_PRNT_ENTY AS SBD_PRNT_ENTY,
A.DIV_ID AS DIV_ID,
A.HUSTLER_DLR_NBR AS HUSTLER_DLR_NBR,
A.DLR_NAME AS DLR_NAME,
A.DLR_LNAME AS DLR_LNAME,
A.DLR_STATE AS DLR_STATE,
A.DLR_CNTRY AS DLR_CNTRY,
A.PRODTN_LN_NBR AS PRODTN_LN_NBR,
A.BRAND AS BRAND,
A.PROD_LN_KEY AS PROD_LN_KEY,
--PROD_LN_DESC,
A.PROD_KEY AS PROD_KEY,
A.PROD_DESC AS PROD_DESC,
A.IR_DTL_SKU AS IR_DTL_SKU,
A.PROD_STAT AS PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(A.PROD_QTY, 30, 2) AS QTY,
TO_DECIMAL(A.AMOUNT,30,2) AS AMOUNT,
TO_DECIMAL(A.AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(A.EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
NULL  AS ORD_LN_NBR,
DATE(A.TXN_DTE) AS TXN_DTE,
A.TXN_TM AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
PO_NBR AS PO_NBR,
A.INVC_NBR AS INVC_NBR,
NULL AS INV_LN_NBR,
A.SERL_NBR AS SERL_NBR,
NULL AS SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
DATE(A.INV_DTE) AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
A.ORD_NBR AS ORD_NBR,
NULL  AS BRAND_UU40,
NULL AS CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
A.LOAN_ID AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
CASE WHEN A.FYR_ID||A.FMTH_ID = B.FYR_ID||B.FMTH_ID THEN 'Y' ELSE 'N' END AS SETLMT_FLAG,
CASE WHEN C.SERL_NBR = A.SERL_NBR AND A.FWK_ID = B.FWK_ID THEN 'Y' ELSE 'N' END AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
 NULL AS FCST_TYP,
DATE(A.INTEREST_START_DTE) AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
DLR_NBR AS DLR_NBR, 
FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
A.BRZ_REF_DTE AS BRZ_REF_DTE

FROM {{source('SALES_BRZ', 'BRZ_SALES_FLOORPLAN_INDEPENDENT_RETAIL')}}  A
LEFT JOIN (SELECT DISTINCT FYR_ID,FWK_ID,FMTH_ID,SERL_NBR,SRC_SYS_KEY,SETLMT_FLAG  FROM {{source('SALES_BRZ', 'BRZ_SALES_SETTLEMENT_INDEPENDENT_RETAIL')}} WHERE SETLMT_FLAG = 'Y'
    --QUALIFY  ROW_NUMBER() OVER (PARTITION BY  UPPER(TRIM(SERL_NBR)) ORDER BY FYR_ID ,FMTH_ID,FWK_ID DESC ) = 1
    )  B
ON A.SERL_NBR = B.SERL_NBR 
AND A.SRC_SYS_KEY=B.SRC_SYS_KEY
LEFT JOIN  (SELECT DISTINCT SERL_NBR,SRC_SYS_KEY from {{source('SALES_BRZ', 'BRZ_SALES_REGISTRATIONS_INDEPENDENT_RETAIL')}})  C
ON A.SERL_NBR = C.SERL_NBR 
AND A.SRC_SYS_KEY=C.SRC_SYS_KEY
     WHERE COALESCE(TRIM(A.TRTRY_KEY), '0') NOT IN ('93')


UNION ALL

----------------------------------------------------------------SHIPMENT----------------------------------------
SELECT
A.CTGY_ID AS CTGY_ID,
A.CTGY_TYP AS CTGY_TYP,
A.CTGY_SHORT_NAME AS CTGY_SHORT_NAME,
A.SRC_SYS_KEY AS SRC_SYS_KEY,
A.PROD_CTGY AS PROD_CTGY,
A.FYR_ID AS FYR_ID,
A.FMTH_ID AS FMTH_ID,
A.FWK_ID AS FWK_ID,
CAST (A.PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(A.PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (A.CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (A.CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
A.REGN_KEY AS REGN_KEY,
CAST(A.TRTRY_KEY AS VARCHAR) AS TRTRY_KEY,
A.DLR_SLS_MGR AS DLR_SLS_MGR,
A.PDM_ID AS PDM_ID,
A.SLS_DEV_SPCL AS SLS_DEV_SPCL,
A.DIST_ID AS DIST_ID,
A.SBD_ENTY_NBR AS SBD_ENTY_NBR,
A.SBD_PRNT_ENTY AS SBD_PRNT_ENTY,
A.DIV_ID AS DIV_ID,
A.HUSTLER_DLR_NBR AS HUSTLER_DLR_NBR,
A.DLR_NAME AS DLR_NAME,
A.DLR_LNAME AS DLR_LNAME,
A.DLR_STATE AS DLR_STATE,
A.DLR_CNTRY AS DLR_CNTRY,
A.PRODTN_LN_NBR AS PRODTN_LN_NBR,
A.BRAND AS BRAND,
A.PROD_LN_KEY AS PROD_LN_KEY,
--PROD_LN_DESC,
A.PROD_KEY AS PROD_KEY,
A.PROD_DESC AS PROD_DESC,
A.IR_DTL_SKU AS IR_DTL_SKU,
A.PROD_STAT AS PROD_STAT,
A.SHIP_FROM AS SHIP_FROM,
A.ORD_TYP AS ORD_TYP,
TO_DECIMAL(A.INV_QTY, 30, 2) AS QTY,
TO_DECIMAL(A.AMOUNT,30,2) AS AMOUNT,
TO_DECIMAL(A.AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(A.EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
A.ORD_LN_NBR AS ORD_LN_NBR,
DATE(A.TXN_DTE) AS TXN_DTE,
A.TXN_TM AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
A.PO_NBR AS PO_NBR,
A.INVC_NBR AS INVC_NBR,
A.INVC_LN_NBR AS INVC_LN_NBR,
A.SERL_NBR AS SERL_NBR,
CAST(A.SITE_ID AS VARCHAR) AS SITE_ID,
A.LOC_ID AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
DATE(A.ORD_DTE) AS ORD_DTE,
NULL AS ORD_DUE_DATE,
DATE(A.INV_DTE) AS INV_DTE,
DATE(A.INV_PO_DTE) AS INV_PO_DTE,
DATE(A.FULL_DUE_DTE) AS FULL_DUE_DTE,
TO_DECIMAL(A.SLS_ORD_QTY,30,2) AS SLS_ORD_QTY,
TO_DECIMAL(A.SHIP_QTY,30,2) AS SHIP_QTY,
--NULL AS FL_PLN_AG,
A.CAL_ON_TIME_FULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
A.ORD_NBR AS ORD_NBR,
A.BRAND_UU40 AS BRAND_UU40,
NULL AS CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
A.CARTON_NBR AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
--CASE WHEN B.SETLMT_FLAG = '1' THEN 'Y' ELSE 'N' END AS SETLMT_FLAG,
--CASE WHEN C.SERL_NBR = A.SERL_NBR AND B.SETLMT_FLAG = '1' THEN 'Y' ELSE 'N' END AS REGISTRATION_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
CUST_ACCT_GRP_DESC AS CUST_ACCT_GRP_DESC,
A.DLR_NBR AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
A.SLS_ORD_FROM_WHSE_KEY AS SLS_ORD_FROM_WHSE_KEY,
A.CREDIT_RESN_LN AS CREDIT_RESN_LN,
A.BRZ_REF_DTE AS BRZ_REF_DTE

FROM  {{source('SALES_BRZ', 'BRZ_SALES_SHIPMENT_INDEPENDENT_RETAIL')}}  A
--LEFT JOIN {{source('SALES_BRZ', 'BRZ_SALES_SETTLEMENT_INDEPENDENT_RETAIL')}}  B
--ON A.SERL_NBR = B.SERL_NBR 
--AND A.SRC_SYS_KEY=B.SRC_SYS_KEY
--LEFT JOIN {{source('SALES_BRZ', 'BRZ_SALES_REGISTRATIONS_INDEPENDENT_RETAIL')}} C
--ON A.SERL_NBR = C.SERL_NBR 
--AND A.SRC_SYS_KEY=C.SRC_SYS_KEY
      WHERE COALESCE(TRIM(A.TRTRY_KEY), '0') NOT IN ('93')
     -- OR  (A.DIV_ID ='52' AND A.DLR_NBR NOT IN ('8033', '16386', '13931'))

UNION ALL


---------------------------------------------------------PRODUCTION_ACTUAL-----------------------------------------

SELECT
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
FWK_ID,
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
NULL AS REGN_KEY,
NULL AS TRTRY_KEY,
NULL AS DLR_SLS_MGR,
NULL AS PDM_ID,
NULL AS SLS_DEV_SPCL,
NULL AS DIST_ID,
NULL AS SBD_ENTY_NBR,
NULL AS SBD_PRNT_ENTY,
NULL AS DIV_ID,
NULL AS HUSTLER_DLR_NBR,
NULL AS DLR_NAME,
NULL AS DLR_LNAME,
NULL AS DLR_STATE,
NULL AS DLR_CNTRY,
 PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(PROD_QTY, 30, 2) AS QTY,
TO_DECIMAL(AMOUNT,30,2) AS AMOUNT,
NULL AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--TXN_ID,
NULL AS ORD_LN_NBR,
 NULL AS TXN_DTE,
 NULL AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
NULL AS PO_NBR,
NULL AS INVC_NBR,
NULL AS INV_LN_NBR,
NULL AS SERL_NBR,
SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
 LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
NULL AS ORD_NBR,
BRAND_UU40,
CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
 NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
NULL AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
BRZ_REF_DTE

FROM {{source('SALES_BRZ', 'BRZ_SALES_PRODUCTION_ACTUAL_INDEPENDENT_RETAIL')}}



UNION ALL

-----------------------------------------------------REGISTRATIONS------------------------------------------------
SELECT
A.CTGY_ID AS CTGY_ID,
A.CTGY_TYP AS CTGY_TYP,
A.CTGY_SHORT_NAME AS CTGY_SHORT_NAME,
A.SRC_SYS_KEY AS SRC_SYS_KEY,
A.PROD_CTGY AS PROD_CTGY,
A.FYR_ID AS FYR_ID,
A.FMTH_ID AS FMTH_ID,
A.FWK_ID AS FWK_ID,
CAST (A.PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(A.PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (A.CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (A.CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
CAST(A.REGN_KEY AS VARCHAR) AS REGN_KEY,
CAST(A.TRTRY_KEY AS VARCHAR) AS TRTRY_KEY,
A.DLR_SLS_MGR AS DLR_SLS_MGR,
A.PDM_ID AS PDM_ID,
A.SLS_DEV_SPCL AS SLS_DEV_SPCL,
A.DIST_ID AS DIST_ID,
A.SBD_ENTY_NBR AS SBD_ENTY_NBR,
A.SBD_PRNT_ENTY AS SBD_PRNT_ENTY,
A.DIV_ID AS DIV_ID,
A.HUSTLER_DLR_NBR AS HUSTLER_DLR_NBR,
A.DLR_NAME AS DLR_NAME,
A.DLR_LNAME AS DLR_LNAME,
A.DLR_STATE AS DLR_STATE,
A.DLR_CNTRY AS DLR_CNTRY,
A.PRODTN_LN_NBR AS PRODTN_LN_NBR,
A.BRAND AS BRAND,
A.PROD_LN_KEY AS PROD_LN_KEY,
--PROD_LN_DESC,
A.PROD_KEY AS PROD_KEY ,
A.PROD_DESC AS PROD_DESC,
A.IR_DTL_SKU AS IR_DTL_SKU,
A.PROD_STAT AS PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(A.PROD_QTY, 30, 2) AS QTY,
B.AMOUNT AS AMOUNT,
TO_DECIMAL(B.AMOUNT_USD,30,2) AS AMOUNT_USD,
TO_DECIMAL(B.EXTND_AMT,30,2) AS EXTND_AMT,
--NULL AS TXN_ID,
NULL AS ORD_LN_NBR,
NULL AS TXN_DTE,
NULL AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
A.PO_NBR AS PO_NBR,
A.INVC_NBR AS INVC_NBR,
NULL AS INV_LN_NBR,
A.SERL_NBR AS SERL_NBR ,
NULL AS SITE,
NULL AS LOC_ID,
NULL AS LOC_KEY,
NULL AS LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
A.ORD_NBR AS ORD_NBR,
BRAND_UU40,
NULL AS CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
NULL AS WHSE_NBR,
CASE WHEN B.SETLMT_FLAG = 'Y' THEN 'Y' ELSE 'N' END AS SETTLEMENT_FLAG,
'Y' AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
A.REG_KEY AS REG_KEY,
DATE(A.REG_DATE)AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
NULL  AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
DLR_NBR AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
A.BRZ_REF_DTE AS BRZ_REF_DTE
 

FROM {{source('SALES_BRZ', 'BRZ_SALES_REGISTRATIONS_INDEPENDENT_RETAIL')}} A
LEFT JOIN (SELECT DISTINCT FWK_ID,SERL_NBR,SRC_SYS_KEY,SETLMT_FLAG,SUM(AMOUNT) AS AMOUNT,SUM(AMOUNT_USD) AS AMOUNT_USD,SUM(EXTND_AMT) AS EXTND_AMT  FROM {{source('SALES_BRZ', 'BRZ_SALES_SETTLEMENT_INDEPENDENT_RETAIL')}} WHERE SETLMT_FLAG = 'Y' GROUP BY ALL)  B
ON A.SERL_NBR = B.SERL_NBR 
AND A.SRC_SYS_KEY=B.SRC_SYS_KEY
      WHERE COALESCE(TRIM(A.TRTRY_KEY), '0') NOT IN ('93')

  UNION ALL

  -----------------------------------------INVENTRY-----------------------------------------------------
  SELECT 
CTGY_ID,
CTGY_TYP,
CTGY_SHORT_NAME,
SRC_SYS_KEY,
PROD_CTGY,
FYR_ID,
FMTH_ID,
 FWK_ID,
CAST (PROG_YR_ID AS INTEGER) AS PROG_YR_ID,
CAST(PROG_MTH_ID AS INTEGER) AS PROG_MTH_ID,
CAST (CLNDR_YR_ID AS INTEGER) AS CLNDR_YR_ID,
CAST (CLNDR_MTH_ID AS INTEGER) AS CLNDR_MTH_ID,
NULL AS REGN_KEY,
NULL AS TRTRY_KEY,
NULL AS DLR_SLS_MGR,
NULL AS PDM_ID,
NULL AS SLS_DEV_SPCL,
NULL AS DIST_ID,
NULL AS SBD_ENTY_NBR,
NULL AS SBD_PRNT_ENTY,
NULL AS DIV_ID,
NULL  AS  HUSTLER_DLR_NBR,
NULL AS DLR_NAME,
NULL AS DLR_LNAME,
NULL AS DLR_STATE,
NULL AS DLR_CNTRY,
PRODTN_LN_NBR,
BRAND,
PROD_LN_KEY,
--PROD_LN_DESC,
PROD_KEY,
PROD_DESC,
IR_DTL_SKU,
PROD_STAT,
NULL AS SHIP_FROM,
NULL AS ORD_TYP,
TO_DECIMAL(PROD_QTY, 30, 2) AS QTY,
TO_DECIMAL(AMOUNT,30, 2) AS AMOUNT,
NULL AS AMOUNT_USD,
TO_DECIMAL(EXTND_AMT,30,2) AS EXTND_AMT,
--NULL AS TXN_ID,
NULL AS ORD_LN_NBR,
 NULL AS TXN_DTE,
 NULL AS TXN_TM,
NULL AS TXN_GL_DTE,
NULL AS TXN_EFF_DTE,
NULL AS TXN_TYP,
NULL AS PO_NBR,
NULL AS INVC_NBR,
NULL AS INV_LN_NBR,
NULL AS SERL_NBR,
SITE_ID,
NULL AS LOC_ID,
NULL AS LOC_KEY,
 LOC_NAME,
NULL AS ORD_DTE,
NULL AS ORD_DUE_DATE,
NULL AS INV_DTE,
NULL AS INV_PO_DTE,
NULL AS FULL_DUE_DTE,
NULL AS SLS_ORD_QTY,
NULL AS SHIP_QTY,
--NULL AS FL_PLN_AG,
NULL AS CAL_ON_TIME_FULL,
NULL AS ORD_STAT_FLAG,
NULL AS OPEN_ORDER_FLAG,
NULL AS INV_LN_KEY,
NULL AS ORD_NBR,
BRAND_UU40,
 CRNCY_KEY,
NULL  AS ORD_HOLD_FLAG,
NULL AS MFG_DUE_DATE,
NULL  AS QUOTE_ORDER_DATE,
NULL  AS ORD_APRV_STAT,
NULL AS OPEN_UNITS,
NULL AS LOAN_ID,
NULL AS SUPPLY_PLND_ORD_KEY,
NULL AS CARTON_NBR,
WHSE_NBR,
NULL AS SETLMT_FLAG,
NULL  AS REGISTRATION_FLAG,
NULL AS CASH_SETTLEMENT_FLAG,
NULL AS REG_KEY,
NULL AS REG_DATE,
NULL AS SETTLEMENT_DTE,
NULL AS SHIPPED_USD,
NULL AS FCST_START_DTE,
 NULL AS FCST_TYP,
NULL AS INTEREST_START_DTE,
DATE(ETL_INS_DTE) AS ETL_INS_DTE,
NULL AS CUST_ACCT_GRP_DESC,
NULL AS DLR_NBR, 
NULL AS FREE_FLOORPLAN_END_DTE,
NULL AS SLS_ORD_FROM_WHSE_KEY,
NULL AS CREDIT_RESN_LN,
BRZ_REF_DTE
FROM {{source('SALES_BRZ', 'BRZ_SALES_INVENTORY_INDEPENDENT_RETAIL')}}

